{"ast":null,"code":"'use strict';\n\n// This file contains then/promise specific extensions that are only useful\n// for node.js interop\nvar Promise = require('./core.js');\nvar asap = require('asap');\nmodule.exports = Promise;\n\n/* Static Functions */\n\nPromise.denodeify = function (fn, argumentCount) {\n  if (typeof argumentCount === 'number' && argumentCount !== Infinity) {\n    return denodeifyWithCount(fn, argumentCount);\n  } else {\n    return denodeifyWithoutCount(fn);\n  }\n};\nvar callbackFn = 'function (err, res) {' + 'if (err) { rj(err); } else { rs(res); }' + '}';\nfunction denodeifyWithCount(fn, argumentCount) {\n  var args = [];\n  for (var i = 0; i < argumentCount; i++) {\n    args.push('a' + i);\n  }\n  var body = ['return function (' + args.join(',') + ') {', 'var self = this;', 'return new Promise(function (rs, rj) {', 'var res = fn.call(', ['self'].concat(args).concat([callbackFn]).join(','), ');', 'if (res &&', '(typeof res === \"object\" || typeof res === \"function\") &&', 'typeof res.then === \"function\"', ') {rs(res);}', '});', '};'].join('');\n  return Function(['Promise', 'fn'], body)(Promise, fn);\n}\nfunction denodeifyWithoutCount(fn) {\n  var fnLength = Math.max(fn.length - 1, 3);\n  var args = [];\n  for (var i = 0; i < fnLength; i++) {\n    args.push('a' + i);\n  }\n  var body = ['return function (' + args.join(',') + ') {', 'var self = this;', 'var args;', 'var argLength = arguments.length;', 'if (arguments.length > ' + fnLength + ') {', 'args = new Array(arguments.length + 1);', 'for (var i = 0; i < arguments.length; i++) {', 'args[i] = arguments[i];', '}', '}', 'return new Promise(function (rs, rj) {', 'var cb = ' + callbackFn + ';', 'var res;', 'switch (argLength) {', args.concat(['extra']).map(function (_, index) {\n    return 'case ' + index + ':' + 'res = fn.call(' + ['self'].concat(args.slice(0, index)).concat('cb').join(',') + ');' + 'break;';\n  }).join(''), 'default:', 'args[argLength] = cb;', 'res = fn.apply(self, args);', '}', 'if (res &&', '(typeof res === \"object\" || typeof res === \"function\") &&', 'typeof res.then === \"function\"', ') {rs(res);}', '});', '};'].join('');\n  return Function(['Promise', 'fn'], body)(Promise, fn);\n}\nPromise.nodeify = function (fn) {\n  return function () {\n    var args = Array.prototype.slice.call(arguments);\n    var callback = typeof args[args.length - 1] === 'function' ? args.pop() : null;\n    var ctx = this;\n    try {\n      return fn.apply(this, arguments).nodeify(callback, ctx);\n    } catch (ex) {\n      if (callback === null || typeof callback == 'undefined') {\n        return new Promise(function (resolve, reject) {\n          reject(ex);\n        });\n      } else {\n        asap(function () {\n          callback.call(ctx, ex);\n        });\n      }\n    }\n  };\n};\nPromise.prototype.nodeify = function (callback, ctx) {\n  if (typeof callback != 'function') return this;\n  this.then(function (value) {\n    asap(function () {\n      callback.call(ctx, null, value);\n    });\n  }, function (err) {\n    asap(function () {\n      callback.call(ctx, err);\n    });\n  });\n};","map":{"version":3,"names":["Promise","require","asap","module","exports","denodeify","fn","argumentCount","Infinity","denodeifyWithCount","denodeifyWithoutCount","callbackFn","args","i","push","body","join","concat","Function","fnLength","Math","max","length","map","_","index","slice","nodeify","Array","prototype","call","arguments","callback","pop","ctx","apply","ex","resolve","reject","then","value","err"],"sources":["/workspace/smartBrain/smartBrain/node_modules/promise/lib/node-extensions.js"],"sourcesContent":["'use strict';\n\n// This file contains then/promise specific extensions that are only useful\n// for node.js interop\n\nvar Promise = require('./core.js');\nvar asap = require('asap');\n\nmodule.exports = Promise;\n\n/* Static Functions */\n\nPromise.denodeify = function (fn, argumentCount) {\n  if (\n    typeof argumentCount === 'number' && argumentCount !== Infinity\n  ) {\n    return denodeifyWithCount(fn, argumentCount);\n  } else {\n    return denodeifyWithoutCount(fn);\n  }\n};\n\nvar callbackFn = (\n  'function (err, res) {' +\n  'if (err) { rj(err); } else { rs(res); }' +\n  '}'\n);\nfunction denodeifyWithCount(fn, argumentCount) {\n  var args = [];\n  for (var i = 0; i < argumentCount; i++) {\n    args.push('a' + i);\n  }\n  var body = [\n    'return function (' + args.join(',') + ') {',\n    'var self = this;',\n    'return new Promise(function (rs, rj) {',\n    'var res = fn.call(',\n    ['self'].concat(args).concat([callbackFn]).join(','),\n    ');',\n    'if (res &&',\n    '(typeof res === \"object\" || typeof res === \"function\") &&',\n    'typeof res.then === \"function\"',\n    ') {rs(res);}',\n    '});',\n    '};'\n  ].join('');\n  return Function(['Promise', 'fn'], body)(Promise, fn);\n}\nfunction denodeifyWithoutCount(fn) {\n  var fnLength = Math.max(fn.length - 1, 3);\n  var args = [];\n  for (var i = 0; i < fnLength; i++) {\n    args.push('a' + i);\n  }\n  var body = [\n    'return function (' + args.join(',') + ') {',\n    'var self = this;',\n    'var args;',\n    'var argLength = arguments.length;',\n    'if (arguments.length > ' + fnLength + ') {',\n    'args = new Array(arguments.length + 1);',\n    'for (var i = 0; i < arguments.length; i++) {',\n    'args[i] = arguments[i];',\n    '}',\n    '}',\n    'return new Promise(function (rs, rj) {',\n    'var cb = ' + callbackFn + ';',\n    'var res;',\n    'switch (argLength) {',\n    args.concat(['extra']).map(function (_, index) {\n      return (\n        'case ' + (index) + ':' +\n        'res = fn.call(' + ['self'].concat(args.slice(0, index)).concat('cb').join(',') + ');' +\n        'break;'\n      );\n    }).join(''),\n    'default:',\n    'args[argLength] = cb;',\n    'res = fn.apply(self, args);',\n    '}',\n    \n    'if (res &&',\n    '(typeof res === \"object\" || typeof res === \"function\") &&',\n    'typeof res.then === \"function\"',\n    ') {rs(res);}',\n    '});',\n    '};'\n  ].join('');\n\n  return Function(\n    ['Promise', 'fn'],\n    body\n  )(Promise, fn);\n}\n\nPromise.nodeify = function (fn) {\n  return function () {\n    var args = Array.prototype.slice.call(arguments);\n    var callback =\n      typeof args[args.length - 1] === 'function' ? args.pop() : null;\n    var ctx = this;\n    try {\n      return fn.apply(this, arguments).nodeify(callback, ctx);\n    } catch (ex) {\n      if (callback === null || typeof callback == 'undefined') {\n        return new Promise(function (resolve, reject) {\n          reject(ex);\n        });\n      } else {\n        asap(function () {\n          callback.call(ctx, ex);\n        })\n      }\n    }\n  }\n};\n\nPromise.prototype.nodeify = function (callback, ctx) {\n  if (typeof callback != 'function') return this;\n\n  this.then(function (value) {\n    asap(function () {\n      callback.call(ctx, null, value);\n    });\n  }, function (err) {\n    asap(function () {\n      callback.call(ctx, err);\n    });\n  });\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}